# Проект 2. Исследование объявлений о продаже квартир

### Вводная: 
Онлайн сервис по продаже недвижимости "Топаз" хочет построить систему для отслеживания аномалий и мошеннической деятельности при продаже квартир.
Вам предоставлен архив объявлений о продаже квартир в Санкт-Петербурге и соседних населённых пунктов за несколько лет. Для каждого объявления доступны два вида данных: заполненные пользователем и полученные автоматически на основе картографических данных. (Например, расстояние до центра, аэропорта, ближайшего парка и водоёма)

### Цель проекта 
Установить параметры, характерные для рыночной стоимости объектов недвижимости. Определить, какие факторы больше всего влияют на стоимость квартиры.

### Что было сделано:
**1.** Мы обработали и проанализировали информацию о 23699 объявлениях с 22-я возможными признаками. В процессе работы были решены следующие проблемы:<br>

**2.** Было выполнено заполнение пропусков. <br>

**Высота потолков** была заполнена медианным значением. Возможной причиной возникновения пропусков является незнание высоты потолков людьми, выставляющими квартиру на продажу.

Количество **этажей в здании** было заполнено на основе архитектуры городов России и информации о этаже квартиры.

Доля пропусков для **жилой площади** квартир была 8%. Для восстановления пропущеных значений была построена модель линейной регрессии по факторам, имеющим сильную корреляцию с жил. площадью – общая площадь и количество комнат.
Пропущенные значения скорее всего опять возникают из-за того, что владельцы просто не знают значений жилой площади.

**Аппартаменты**<br>
Природа пропущенных значений до конца не ясна. Cкорее всего этот пункт – "радио" кнопка на сайте, и нажать её не должно быть сложно. Однако мы видим что доля пропущенных значений целых 88.3 процентов. Либо люди сомневаются в значении слова "аппартаменты" и не выбирают ничего, либо есть проблемы в дизайне сайта и люди просто не видят эту кнопку - это необходимо проверить.  
Мы приняли предположение о том, что кнопку видно и люди просто не знают что это за тип жилья. А раз не знают, то, скорее всего у них обычная квартира. Поэтому пропущенные значения были заменены на False.

Чтобы восстановить данные о **площади кухни** мы использовали формулу Площадь кухни = Общая площадь - Жилая площадь. 

Для **количества балконов** мы использовали следующую логику: если человек не указал число балконов — скорее всего, их нет. Такие пропуски были заменены на 0.

Далее у нас идут значения, которые заполняются автоматически, на основе геолокации. Это locality_name    airports_nearest    cityCenters_nearest. Их мы восстановить никак не можем, их можно заменять на `unknown`, но, для удобства дальнейшего анализа, на данном этапе мы этого делать не стали.
Судя по данным, здесь пропуски возникают в тех случаях, когда квартиры расположены в поселках, деревнях, а иногда и, возможно, вне мест совместного обитания человека. Для таких мест просто нету достаточной информации у геолокационных сервисов.

Сколько дней было размещено объявление. <br>
Зафиксировали что данные имеют тип float, так как у нас не было нулевых значений, скорее всего `NaN` – были открытыми объявлениями. Им мы присвоили статус `open`.

Произведено приведение данных к нужным типам.  <br>
Столбец `first_day_exposition` был привден к формату `datetime`, мы получили точность временного значения до дней.

**3.** Мы посчитали и добавили в таблицу:
- цену квадратного метра;
- день недели, месяц и год публикации объявления;
- этаж квартиры; варианты — первый, последний, другой;
- соотношение жилой и общей площади, а также отношение площади кухни к общей.

**4.** Проведен исследовательский анализ данных.  
<br>
**4.1.** Мы изучили: площадь, цену, число комнат, высоту потолков. Построили гистограммы для каждого параметра.

**Общая площадь**
На гистограмме выявлено 3 пика. Первый, около 28 м2, соответствовал однокомнатным квартирам, второй пик – примерно 48 м2,  двухкомнатным квартирам, и третий пик около 60 м2 - трехкомнатным.

**Цена квартиры**
Пиковове значение около 3.2 млн. рублей. Можно сказать что распределение стремится к нормальному, с длинным хвостом справа.

**Количество комнат**
На гистограмме было видно, что самое большое количество квартир 1- и 2-х комнатные. Также видим что в данных есть несколько аномальных нулевых значений.

Для **высоты потолков** пик находился на медианном значении (2.6 м), при этом помним о том, что пропущенные значения мы заполняли именно им (их было 38% от общего числа). 

**4.2.** Далее мы изучили время продажи квартиры. Распределение оказалось близко к Пуассоновскому. Можно наблюдать интересный пик на значениях 45 и 60 дней. Возможно на этом сроке сервис автоматически закрывает определенный тип объявлений (например, неинтересные или плохо заполненные).

Медианное значение 95 дней – половина объявлений закрывается за этот срок. Можно считать, что продажи прошли быстро, если квартира продана за 45 дней. Необычно долгие продажи начинаются от 232 и могут продолжаться аж до 1580 дней.

**4.3.** Редкие и выбивающиеся значения были убраны. 
Необходимо было обработать столбцы: `last_price, total_area, rooms, ceiling_height`.

`last_price`
Согласно данным, самая дешевая квартира была продана за 12 т.р, а самая дорогая – за 763 000 000 рублей.
После анализа данных за верхнее значение было принято 50 млн. рублей, а за нижнее – 400 т.р. 

`total_area`
Здесь опять мы видим длинный хвост справа, который, вероятно появляется из-за продаж загородных домов. Установим верхнюю границу в 250 м2, нижний порог в 20 м2.

`rooms`
Было обнаружено, что значения 0 возникают когда продается либо студия, либо квартира с открытой планировкой. По техническим документам это однокомнатная квартира, поэтому такие значения мы заменяли на 1.
Что касается больших значений – была установлена верхняя граница в 7 комнат.

`ceiling_height`
Ограничили значения высоты потолков 2мя метрами снизу и 5ю метрами сверху.

**4.4.** Какие факторы больше всего влияют на стоимость квартиры?

* Ярко выраженной линейной зависимости не было найдено, однако можно сказать, что цена продажи наиболее сильно зависит от общей площади квартиры (коэффициент корреляции 0.78).  

* Высокая корреляция с ценой за м2 частично объясняется тем, что мы считали это значение на основе цены.
* Также отметим корреляцию факторов`kitchen_area` (0.50) и `living_area` (0.67).

* Зависимость от числа комнат:
    Видим положительно направленную зависимость – чем больше комнат, тем больше может быть цена за квартиру.

* Удаленность от центра: 
    линейной зависимости нет – график стремится к гиперболе. Самые дорогие квартиры чаще всего встречаются в городе/пригороде (до 20км от центра).

* Зависимость цены от того, на каком этаже расположена квартира: 
    На графиках видно, что цены для первого и последнего этажа особо не отличаются, а вот у "остальных" частота значений слева от пика уменьшилась, что значит такие квартиры в среднем дороже.

**Зависимость от даты размещения:**
- Для дня недели было найдено что самая высокая (медианная) цена наблюдается в понедельник (день 1), а самая низкая – в субботу.
- Судя по месячному графику, самая высокая цена на квартиры в апреле, а самая низкая – в июне.
- Мы отметили, что в 2014 году цена была самой высокой (медиана около 7.8 млн) и падала до 2017 года (4.4 млн). После этого цены начали медленно расти.

**4.5.** Статистика для топ 10 населённых пунктов с наибольшим числом объявлений.
Мы получили список из топ 10 населённых пунктов с наибольшим числом объявлений, после этого его упорядочли и построили график по средней цене за м2.

Самая высокая стоимость одного квадратного метра получилась в Санкт-Петербурге, а самая низкая – в Выборге.

**4.6.** Санкт-Петербург. Как цена квартиры зависит от удалённости от центра.
Анализ показал, что самая высокая цена на квартиры в диаметре 1 км от самого центра. После этого средняя цена падает до значения 3 км, после чего начинает расти. Второе падение можно наблюдать около значения 8 км. Скорее всего, цены немного падают когда мы отходим от самого центра, и немного возрастают когда мы подходим к границе центра. Поэтому мы приняли за границу центра всё до значения в 8 км.

**4.7.** Анализ сегмента квартир в центре Санкт-Петербурга.  
Был проанализирован сегмента квартир в центре Санкт-Петербурга, изучены следующие параметры: площадь, цена, число комнат, высота потолков. Было проведено сравнение с общими выводами по всему городу.

Сравнивая данные можно видеть, что: в центре медианные значения и площади и цены больше чем в целом по городу.
Это очень интересно, так как это противоречит стереотипу о том, что обычно квартиры в центре маленькие и дорогие. Согласно нашей статистике, они и дороже, и больше, чем все квартиры в городе Санкт-Петербург.

Что касается комнат, то здесь опять стереотип не работает – медианное значение для центра 3 комнаты, для всего города - 2.
Про высоту потолков с уверенностью сказать нельзя. Так как мы заполняли большое количество пропущенных данных медианным значением – при увеличении размера выборки её медиана будет стремиться к общей по всем данным. 

Также мы выделили факторы, которые влияют на стоимость квартиры (число комнат, этаж, удалённость от центра, дата размещения объявления).
Здесь ситуация оказалась схожа с общей по всем данным - мы наблюдали тот же набор коррелирующих факторов living_area (0.58), m2_price (0.65), total_area (0.70). Немного уменьшилась корреляция с площадью кухни и стала меньше 0.5.
</br>